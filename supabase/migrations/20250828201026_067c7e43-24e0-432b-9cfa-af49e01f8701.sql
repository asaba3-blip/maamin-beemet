-- Fix the chronological order of Torah portions under מקרא
-- First, let's create the proper order for the weekly Torah portions (parashot)

-- Delete existing Torah portions if they exist to avoid duplicates
DELETE FROM topics WHERE parent_id = (SELECT id FROM topics WHERE name = 'מקרא' LIMIT 1) AND name != 'מקרא';

-- Get the parent ID for מקרא
DO $$
DECLARE
    mikra_id UUID;
BEGIN
    SELECT id INTO mikra_id FROM topics WHERE name = 'מקרא' LIMIT 1;
    
    -- Insert Torah portions in proper chronological order (as they appear in the Torah)
    INSERT INTO topics (name, description, parent_id) VALUES 
    -- ספר בראשית
    ('בראשית', 'פרשת בראשית - בריאת העולם', mikra_id),
    ('נח', 'פרשת נח - המבול וברית נח', mikra_id),
    ('לך לך', 'פרשת לך לך - קריאת אברהם', mikra_id),
    ('וירא', 'פרשת וירא - אברהם ושלושת המלאכים', mikra_id),
    ('חיי שרה', 'פרשת חיי שרה - מות שרה ונישואי יצחק', mikra_id),
    ('תולדות', 'פרשת תולדות - יצחק ועשו ויעקב', mikra_id),
    ('ויצא', 'פרשת ויצא - יעקב בבית לבן', mikra_id),
    ('וישלח', 'פרשת וישלח - יעקב חזר לארץ ישראל', mikra_id),
    ('וישב', 'פרשת וישב - יוסף ואחיו', mikra_id),
    ('מקץ', 'פרשת מקץ - יוסף מפרש חלומות', mikra_id),
    ('ויגש', 'פרשת ויגש - יהודה ויוסף', mikra_id),
    ('ויחי', 'פרשת ויחי - יעקב מברך את בניו', mikra_id),
    
    -- ספר שמות
    ('שמות', 'פרשת שמות - שעבוד מצרים', mikra_id),
    ('וארא', 'פרשת וארא - מכות מצרים', mikra_id),
    ('בא', 'פרשת בא - המכות האחרונות ויציאת מצרים', mikra_id),
    ('בשלח', 'פרשת בשלח - קריעת ים סוף', mikra_id),
    ('יתרו', 'פרשת יתרו - מתן תורה', mikra_id),
    ('משפטים', 'פרשת משפטים - דיני התורה', mikra_id),
    ('תרומה', 'פרשת תרומה - בניין המשכן', mikra_id),
    ('תצוה', 'פרשת תצוה - בגדי כהונה', mikra_id),
    ('כי תשא', 'פרשת כי תשא - חטא העגל', mikra_id),
    ('ויקהל', 'פרשת ויקהל - בניין המשכן', mikra_id),
    ('פקודי', 'פרשת פקודי - השלמת המשכן', mikra_id),
    
    -- ספר ויקרא
    ('ויקרא', 'פרשת ויקרא - קרבנות', mikra_id),
    ('צו', 'פרשת צו - דיני הקרבנות', mikra_id),
    ('שמיני', 'פרשת שמיני - חנוכת המשכן', mikra_id),
    ('תזריע', 'פרשת תזריע - דיני טהרה', mikra_id),
    ('מצורע', 'פרשת מצורע - דיני צרעת', mikra_id),
    ('אחרי מות', 'פרשת אחרי מות - עבודת יום הכפורים', mikra_id),
    ('קדושים', 'פרשת קדושים - קדושת עם ישראל', mikra_id),
    ('אמור', 'פרשת אמור - דיני כהנים ומועדים', mikra_id),
    ('בהר', 'פרשת בהר - שמיטה ויובל', mikra_id),
    ('בחקותי', 'פרשת בחקותי - ברכות וקללות', mikra_id),
    
    -- ספר במדבר
    ('במדבר', 'פרשת במדבר - מניין בני ישראל', mikra_id),
    ('נשא', 'פרשת נשא - ברכת כהנים', mikra_id),
    ('בהעלותך', 'פרשת בהעלותך - הדלקת המנורה', mikra_id),
    ('שלח לך', 'פרשת שלח לך - חטא המרגלים', mikra_id),
    ('קרח', 'פרשת קרח - מחלוקת קרח', mikra_id),
    ('חקת', 'פרשת חקת - פרה אדומה', mikra_id),
    ('בלק', 'פרשת בלק - בלעם ובלק', mikra_id),
    ('פינחס', 'פרשת פינחס - קנאות פינחס', mikra_id),
    ('מטות', 'פרשת מטות - דיני נדרים', mikra_id),
    ('מסעי', 'פרשת מסעי - מסעות בני ישראל', mikra_id),
    
    -- ספר דברים
    ('דברים', 'פרשת דברים - נאום משה', mikra_id),
    ('ואתחנן', 'פרשת ואתחנן - עשרת הדברות', mikra_id),
    ('עקב', 'פרשת עקב - ברכת הארץ', mikra_id),
    ('ראה', 'פרשת ראה - בחירה בין טוב לרע', mikra_id),
    ('שופטים', 'פרשת שופטים - מערכת המשפט', mikra_id),
    ('כי תצא', 'פרשת כי תצא - דיני המלחמה', mikra_id),
    ('כי תבוא', 'פרשת כי תבוא - ברכות וקללות', mikra_id),
    ('נצבים', 'פרשת נצבים - ברית בערבות מואב', mikra_id),
    ('וילך', 'פרשת וילך - מינוי יהושע', mikra_id),
    ('האזינו', 'פרשת האזינו - שירת האזינו', mikra_id),
    ('וזאת הברכה', 'פרשת וזאת הברכה - ברכת משה', mikra_id);
END $$;